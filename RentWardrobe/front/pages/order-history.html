<!DOCTYPE html>
<html lang="uk">

<!-- Верхній рядок -->
<div class="top-message">
  <span>YOUR PERFECT PROM LOOK STARTS HERE</span>
  <span>YOUR PERFECT PROM LOOK STARTS HERE</span>
  <span>YOUR PERFECT PROM LOOK STARTS HERE</span>
</div>

<head>
  <meta charset="UTF-8" />
  <title>RentWardrobe - Історія замовлень</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/styles/userProfile.css" />
</head>
<body>
<header>
  <a href="index.html" style="color: inherit; text-decoration: none;">
    <div class="logo">RentWardrobe</div>
  </a>
  <nav class="menu">
    <ul>
      <li><a href="#">Жіночий</a></li>
      <li><a href="#">Чоловічий</a></li>
      <li><a href="#">Пошук</a></li>
      <li><a href="userProfile.html">Особистий кабінет</a></li>
    </ul>
  </nav>
  <div class="header-icons">
    <a href="cart.html"><i class="fa-solid fa-cart-shopping"></i></a>
    <a href="userProfile.html"><i class="fa-solid fa-user"></i></a>
  </div>
</header>

<div class="cabinet-container">
  <h2 class="cabinet-title">ІСТОРІЯ ЗАМОВЛЕНЬ</h2>
  <div class="orders-list" id="ordersList"></div>
</div>

<script>
  const currentUserEmail = localStorage.getItem('currentUserEmail');

  async function loadOrders() {
    if (!currentUserEmail) return;

    try {
      const res = await fetch(`/api/user/${currentUserEmail}/orders`);
      const orders = await res.json();
      const container = document.getElementById('ordersList');

      if (!orders.length) {
        container.innerHTML = '<p>У вас ще немає замовлень.</p>';
        return;
      }

      orders.forEach(order => {
        const div = document.createElement('div');
        div.className = 'order-card';
        div.innerHTML = `
            <h4>Замовлення №${order.id}</h4>
            <p><strong>Ім’я:</strong> ${order.name}</p>
            <p><strong>Телефон:</strong> ${order.phone}</p>
            <p><strong>Доставка:</strong> ${order.delivery} (${order.address})</p>
            <p><strong>Оплата:</strong> ${order.payment}</p>
            <p><strong>Коментар:</strong> ${order.comment || '-'}</p>
            <h5>Товари:</h5>
            <ul>
              ${order.cart.map(item => `
                <li>${item.title} — ${item.quantity} шт — ${item.price}</li>
              `).join('')}
            </ul>
          `;
        container.appendChild(div);
      });
    } catch (err) {
      console.error('Помилка при завантаженні замовлень:', err);
    }
  }

  window.onload = loadOrders;
</script>
</body>
</html>