<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8" />
    <title>RentWardrobe - Деталі товару</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
            href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&display=swap"
            rel="stylesheet"
    />
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
    />
    <link rel="stylesheet" href="../styles/product.css" />
</head>
<body>

<!-- Верхній рядок -->
<div class="top-message">
    <span>YOUR PERFECT PROM LOOK STARTS HERE</span>
</div>

<!-- Шапка -->
<header>
    <a href="index.html" style="color: inherit; text-decoration: none;">
        <div class="logo">RentWardrobe</div>
    </a>
    <nav class="top-nav">
        <ul>
            <li><a href="#">Жіночий</a></li>
            <li><a href="#">Чоловічий</a></li>
            <li><a href="#" id="profileLink">Особистий кабінет</a></li>
        </ul>
    </nav>
    <div class="header-icons">
        <a href="cart.html">
            <i class="fa-solid fa-cart-shopping"></i>
        </a>
        <a href="#" id="profileLinkIcon">
            <i class="fa-solid fa-user"></i>
        </a>
    </div>
</header>

<!-- Контейнер товару -->
<div class="product-container">
    <div class="breadcrumbs">
        <a href="#">RentWardrobe</a> /
        <span id="breadcrumbTitle">Назва товару</span>
    </div>

    <div class="product-main">
        <div class="main-image">
            <img src="../pictures/placeholder.jpg" alt="Main" id="mainPhoto" />
        </div>

        <!-- Опис товару справа -->
        <div class="product-info">
            <h1 id="productTitle">Назва товару</h1>
            <p class="article" id="productCode">Код: NO-000000</p>

            <div class="price-block">
                <span class="price" id="productPrice">14 990 грн</span>
                <span class="in-stock">В наявності</span>
            </div>

            <!-- Зірочки (рейтинг) -->
            <span class="fa fa-star checked"></span>
            <span class="fa fa-star checked"></span>
            <span class="fa fa-star checked"></span>
            <span class="fa fa-star checked"></span>
            <span class="fa fa-star checked"></span>

            <div class="size-block">
                <h4>Виберіть розмір:</h4>
                <div class="sizes">
                    <button class="size-btn">XS</button>
                    <button class="size-btn">S</button>
                    <button class="size-btn">M</button>
                    <button class="size-btn">L</button>
                </div>
                <p class="price-per-day">
                    Вартість оренди: <strong id="rentPrice">1000 грн/добу</strong>
                </p>
            </div>

            <div class="buttons-block">
                <button class="add-to-cart">В кошик</button>
                <button class="buy-1-click">Замовити в 1 клік</button>
            </div>

            <!-- Вкладки (Опис, Характеристики, Заміри виробу, Доставка і оплата, Відгук) -->
            <div class="tabs">
                <button class="tab-link active" data-tab="tab-description">Опис</button>
                <button class="tab-link" data-tab="tab-characteristics">Характеристики</button>
                <button class="tab-link" data-tab="tab-measures">Заміри виробу</button>
                <button class="tab-link" data-tab="tab-delivery">Доставка і оплата</button>
                <button class="tab-link" data-tab="tab-review">Відгук</button>
            </div>

            <!-- Контейнер із вмістом вкладок -->
            <div class="tab-content active" id="tab-description">
                <p id="descriptionText">
                    Тут з’явиться опис товару з JavaScript...
                </p>
            </div>
            <div class="tab-content" id="tab-characteristics">
                <ul>
                    <li>Матеріал: Шовк</li>
                    <li>Колір: Бордовий</li>
                    <li>Довжина: Максі</li>
                    <li>Рукав: Відкриті плечі</li>
                </ul>
            </div>
            <div class="tab-content" id="tab-measures">
                <p>Довжина виробу: 150 см</p>
            </div>
            <div class="tab-content" id="tab-delivery">
                <p>Доставка Новою Поштою по всій Україні.</p>
            </div>
            <div class="tab-content" id="tab-review">
                <p>чудове плаття 10/10.</p>
            </div>
        </div>
    </div>
</div>

<script>
    // Логіка вкладок
    const tabLinks = document.querySelectorAll('.tab-link');
    const tabContents = document.querySelectorAll('.tab-content');
    tabLinks.forEach((btn) => {
        btn.addEventListener('click', () => {
            tabLinks.forEach((item) => item.classList.remove('active'));
            btn.classList.add('active');
            tabContents.forEach((content) => content.classList.remove('active'));
            const tabId = btn.getAttribute('data-tab');
            const currentTab = document.getElementById(tabId);
            currentTab.classList.add('active');
        });
    });
</script>

<script>
    // Отримання даних товару з sessionStorage
    const productJSON = sessionStorage.getItem('selectedProduct');
    if (productJSON) {
        const product = JSON.parse(productJSON);
        document.getElementById('breadcrumbTitle').textContent = product.title;
        document.getElementById('productTitle').textContent = product.title;
        document.getElementById('mainPhoto').src = product.img;
        document.getElementById('productPrice').textContent = product.price;
        document.getElementById('productCode').textContent = 'Код: ' + (product.code || 'NO-000000');
        document.getElementById('rentPrice').textContent = product.rentPrice || '1000 грн/добу';
        document.getElementById('descriptionText').textContent = product.description;

        const sizesBlock = document.querySelector('.sizes');
        sizesBlock.innerHTML = '';

        if (product.sizes && Array.isArray(product.sizes)) {
            product.sizes.forEach(size => {
                const button = document.createElement('button');
                button.className = 'size-btn';
                button.textContent = size;
                sizesBlock.appendChild(button);
            });
        }
        product.rating = product.rating || 5;
        sessionStorage.setItem('selectedProduct', JSON.stringify(product));
    }
</script>

<script>
    // Обробка вибору розміру
    const sizeButtons = document.querySelectorAll('.size-btn');
    sizeButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            sizeButtons.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
        });
    });

    // Додавання товару до кошика
    document.querySelector('.add-to-cart').addEventListener('click', function() {
        const productJSON = sessionStorage.getItem('selectedProduct');
        if (productJSON) {
            const product = JSON.parse(productJSON);
            product.quantity = 1;
            // Отримуємо вибраний розмір
            const selectedSizeBtn = document.querySelector('.size-btn.active');
            product.size = selectedSizeBtn ? selectedSizeBtn.textContent : (product.size || 'N/A');
            // Забезпечуємо наявність рейтингу та оренди
            product.rating = product.rating || 5;
            product.rentPrice = product.rentPrice || '1000 грн/добу';

            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            // Перевірка наявності товару з однаковим кодом і розміром
            const existingProductIndex = cart.findIndex(item => item.code === product.code && item.size === product.size);
            if (existingProductIndex !== -1) {
                cart[existingProductIndex].quantity += 1;
            } else {
                cart.push(product);
            }
            localStorage.setItem('cart', JSON.stringify(cart));
            alert('Товар додано до кошика!');
        } else {
            alert('Дані про товар не знайдено!');
        }
    });

    // Обробка переходу до профілю
    function handleProfileClick(event) {
        event.preventDefault();
        window.location.href = 'userProfile.html';
    }
    document.getElementById('profileLink').addEventListener('click', handleProfileClick);
    document.getElementById('profileLinkIcon').addEventListener('click', handleProfileClick);
</script>

</body>
</html>
